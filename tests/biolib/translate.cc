#include <catch2/catch_test_macros.hpp>

#include <bio/translate.hh>

TEST_CASE("translate", "[biolib]")
{

    auto orfs = bio::translate(std::string{
        "GACTTTATATTTAGTGTTTGGAGCTTGATCTGCCATAGTAGGTACTGCTATAAGTGTGCTAATTCGGGTTGAATTAGGTCAACCTGGGAGATTATTAGGGGATGATCAATTATACAATGTAATTGTAACAGGACATGCTTTTGTAATGATTTTTTTTATAGTTATACCAATTTTAATTGGAGGTTTTGGAAATTGGTTAGTTCCTTTGATATTAGGAGCTCCCGATATAGCTTTTCCTCGGATAAATAATTTGAGATTTTGATTATTACCTCCTTCTTTATTATTATTATTTATTTCTTCTATAGAAGAAATAGGGGTTGGGGCAGGTTGGACTATTTACCCTCCTTTATCTTCTTTAGAAGGGCATAGAGGGAGCTCTGTAGATTTTGCTATTTTCTCTTTACATTTAGCAGGTGCTTCATCTATTATAGGGGCTATTAATTTTATTTCTACTATTTTTAATATACGTATATATGGTATAAGATTAGAAAAGGTTAGATTGTTTGTTTGGTCGGTTTTAATTACAGCTGTATTGTTATTATTATCATTACCAGTATTAGCAGGGGCTATTACTATATTATTAACCGATCGAAATTTTAATACTTCATTTTTTGATCCTGCTGGGGGAGGTGATCCTATTTTATTTCAACATTTATTT"
    });

    REQUIRE(orfs[0] == "DFIFSVWSLICHSRYCYKCANSG-IRSTWEIIRG-SIIQCNCNRTCFCNDFFYSYTNFNWRFWKLVSSFDIRSSRYSFSSDK-FEILIITSFFIIIIYFFYRRNRGWGRLDYLPSFIFFRRA-RELCRFCYFLFTFSRCFIYYRGY-FYFYYF-YTYIWYKIRKG-IVCLVGFNYSCIVIIIITSISRGYYYIINRSKF-YFIF-SCWGR-SYFISTFI");
    REQUIRE(orfs[1] == "TLYLVFGA-SAIVGTAISVLIRVELGQPGRLLGDDQLYNVIVTGHAFVMIFFIVIPILIGGFGNWLVPLILGAPDIAFPRINNLRF-LLPPSLLLLFISSIEEIGVGAGWTIYPPLSSLEGHRGSSVDFAIFSLHLAGASSIIGAINFISTIFNIRIYGIRLEKVRLFVWSVLITAVLLLLSLPVLAGAITILLTDRNFNTSFFDPAGGGDPILFQHLF");
    REQUIRE(orfs[2] == "LYI-CLELDLP--VLL-VC-FGLN-VNLGDY-GMINYTM-L-QDMLL--FFL-LYQF-LEVLEIG-FL-Y-ELPI-LFLG-II-DFDYYLLLYYYYLFLL-KK-GLGQVGLFTLLYLL-KGIEGAL-ILLFSLYI-QVLHLL-GLLILFLLFLIYVYMV-D-KRLDCLFGRF-LQLYCYYYHYQY-QGLLLYY-PIEILILHFLILLGEVILFYFNIY");
}